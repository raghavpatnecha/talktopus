<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ConferenceFlow</title>
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Road+Rage&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/siriwave/dist/siriwave.umd.min.js"></script>
    <script type="module" src="/lib/wavtools/index.js"></script>
    <script type="module" src="/main.js"></script>
    <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.20.0.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <img src="assets/logo_oct.png" alt="ConferenceFlow Logo" class="logo-image">
                <h2>Talktopus</h2>
            </div>
            <div class="header-center">
                <div id="translation-status" class="translation-status">
                    <!-- This will be populated by JavaScript -->
                </div>
                <div class="meeting-info">
                    <span>Meeting ID: 123-456-789</span>
                    <button class="gradient-button" id="join">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"/>
                        </svg>
                        Join Call
                    </button>
                </div>
            </div>
            <div class="header-right">
                <button class="menu-item" id="toggleLogs">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path fill-rule="evenodd" d="M3 6a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6Zm3-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H6Zm1.293 4.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1 0 1.414l-2 2a1 1 0 0 1-1.414-1.414L8.586 12l-1.293-1.293a1 1 0 0 1 0-1.414ZM12 14a1 1 0 0 1 1-1h3a1 1 0 1 1 0 2h-3a1 1 0 0 1-1-1Z"/>
                    </svg>Logs</button>
                <a href="https://github.com/yourusername/yourrepo" target="_blank" class="menu-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12"/>
                    </svg>GitHub</a>
            </div>
        </header>

        <!-- Main Content: Video Grid -->
        <main class="video-grid" id="video-grid">
            <div class="video-panel self-panel">
                <div class="sound-bars">
                    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                </div>
                <div class="video-circle-container">
                    <div class="video-circle" id="self-video">
                        <div class="video-placeholder">
                            <img src="" alt="User illustration" class="avatar-illustration">
                        </div>
                    </div>
                </div>
                <div class="conversation-area">
                    <div class="conversation">
                        <div class="transcript-container">
                            <div class="transcript-group">
                                <label for="user-transcript">Transcript</label>
                                <div id="user-transcript" class="transcript-box"></div>
                            </div>
                            <div class="transcript-group">
                                <label for="assistant-transcript">Translated Transcript</label>
                                <div id="assistant-transcript" class="transcript-box"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-info">
                    <span class="name-tag">You (You)</span>
                    <span class="mic-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line></svg>
                    </span>
                </div>
            </div>
        </main>

        <!-- Bottom Controls -->
        <footer class="controls-bar">
             <button class="control-button" id="pushToTalk" title="Mute / Unmute (Push to Talk)" data-tooltip="(Push to Talk)">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line></svg>
            </button>
            <button class="control-button" id="toggle-video-btn" title="Start / Stop Video" data-tooltip="Toggle Video">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 7l-7 5 7 5V7z"></path><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>
            </button>
            <div class="toggle-group">
                <button class="toggle-btn active" data-mode="manual">manual</button>
                <button class="toggle-btn" data-mode="vad">vad</button>
            </div>
            <button class="control-button" id="translate-settings-btn" title="Translation Settings" data-tooltip="Translation Settings">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-languages text-slate-400 pointer-events-none"><path d="m5 8 6 6"></path><path d="m4 14 6-6 2-3"></path><path d="M2 5h12"></path><path d="M7 2h1"></path><path d="m22 22-5-10-5 10"></path><path d="M14 18h6"></path></svg>
            </button>
            <button class="control-button end-call-btn" title="End Call" data-tooltip="End Call">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.68 13.31a16 16 0 0 0 3.41 2.39l1.1-1.1a2 2 0 0 1 2.11-.45c.84.27 1.72.46 2.62.57a2 2 0 0 1 2.09 2.09v3.31a2 2 0 0 1-2.19 2.19c-10.63 0-19.28-8.65-19.28-19.28A2 2 0 0 1 5.31 2h3.31a2 2 0 0 1 2.09 2.09c.11.9.3 1.78.57 2.62a2 2 0 0 1-.45 2.11l-1.1 1.1a16 16 0 0 0 2.39 3.41z"/></svg>
            </button>
        </footer>

        <!-- Translation Settings Panel -->
        <div id="translation-settings-panel" class="settings-panel-container hidden">
            <div class="settings-panel">
                <div class="settings-header">
                    <h3>Translation Settings</h3>
                    <button id="close-settings-btn" class="close-btn">&times;</button>
                </div>
                <div class="settings-content">
                    <div class="language-selector-container">
                        <div class="setting-item">
                            <label>I speak:</label>
                            <div class="custom-select" id="source-language-select">
                                <div class="custom-select-trigger">
                                    <span class="selected-language-text">English</span>
                                    <span class="selected-language-flag">ðŸ‡ºðŸ‡¸</span>
                                </div>
                                <div class="custom-options">
                                    <div class="custom-option" data-value="English" data-flag="ðŸ‡ºðŸ‡¸">English ðŸ‡ºðŸ‡¸</div>
                                    <div class="custom-option" data-value="Hindi" data-flag="ðŸ‡®ðŸ‡³">Hindi ðŸ‡®ðŸ‡³</div>
                                    <div class="custom-option" data-value="Spanish" data-flag="ðŸ‡ªðŸ‡¸">Spanish ðŸ‡ªðŸ‡¸</div>
                                    <div class="custom-option" data-value="French" data-flag="ðŸ‡«ðŸ‡·">French ðŸ‡«ðŸ‡·</div>
                                    <div class="custom-option" data-value="German" data-flag="ðŸ‡©ðŸ‡ª">German ðŸ‡©ðŸ‡ª</div>
                                    <div class="custom-option" data-value="Japanese" data-flag="ðŸ‡¯ðŸ‡µ">Japanese ðŸ‡¯ðŸ‡µ</div>
                                    <div class="custom-option" data-value="Gujrati" data-flag="ðŸ‡®ðŸ‡³">Gujrati ðŸ‡®ðŸ‡³</div>
                                    <div class="custom-option" data-value="Malayalam" data-flag="ðŸ‡®ðŸ‡³">Malayalam ðŸ‡®ðŸ‡³</div>
                                </div>
                            </div>
                        </div>

                        <button id="swap-languages-btn" class="control-button" data-tooltip="Swap Languages">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 2.1l4 4-4 4"/><path d="M3 12.2v-2a4 4 0 0 1 4-4h14"/><path d="M7 21.9l-4-4 4-4"/><path d="M21 11.8v2a4 4 0 0 1-4 4H3"/></svg>
                        </button>

                        <div class="setting-item">
                            <label>Translate to:</label>
                            <div class="custom-select" id="target-language-select">
                                <div class="custom-select-trigger">
                                    <span class="selected-language-text">Hindi</span>
                                    <span class="selected-language-flag">ðŸ‡®ðŸ‡³</span>
                                </div>
                                <div class="custom-options">
                                    <div class="custom-option" data-value="Hindi" data-flag="ðŸ‡®ðŸ‡³">Hindi ðŸ‡®ðŸ‡³</div>
                                    <div class="custom-option" data-value="English" data-flag="ðŸ‡ºðŸ‡¸">English ðŸ‡ºðŸ‡¸</div>
                                    <div class="custom-option" data-value="Spanish" data-flag="ðŸ‡ªðŸ‡¸">Spanish ðŸ‡ªðŸ‡¸</div>
                                    <div class="custom-option" data-value="French" data-flag="ðŸ‡«ðŸ‡·">French ðŸ‡«ðŸ‡·</div>
                                    <div class="custom-option" data-value="German" data-flag="ðŸ‡©ðŸ‡ª">German ðŸ‡©ðŸ‡ª</div>
                                    <div class="custom-option" data-value="Japanese" data-flag="ðŸ‡¯ðŸ‡µ">Japanese ðŸ‡¯ðŸ‡µ</div>
                                    <div class="custom-option" data-value="Gujrati" data-flag="ðŸ‡®ðŸ‡³">Gujrati ðŸ‡®ðŸ‡³</div>
                                    <div class="custom-option" data-value="Malayalam" data-flag="ðŸ‡®ðŸ‡³">Malayalam ðŸ‡®ðŸ‡³</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p class="summary-text">Your speech in <span id="summary-source">English</span> will be translated to <span id="summary-target">Hindi</span> for other participants.</p>
                </div>
                <div class="settings-footer">
                    <button id="enable-translation-btn" class="gradient-button">Enable Translation</button>
                </div>
            </div>
        </div>
    </div>
    <div id="logsSidebar" class="logs-sidebar">
        <div class="logs-header">
            <div class="logs-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M3 6a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6Zm3-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H6Zm1.293 4.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1 0 1.414l-2 2a1 1 0 0 1-1.414-1.414L8.586 12l-1.293-1.293a1 1 0 0 1 0-1.414ZM12 14a1 1 0 0 1 1-1h3a1 1 0 1 1 0 2h-3a1 1 0 0 1-1-1Z"/></svg>
                <span>Logs</span>
            </div>
            <button id="clearLogs" class="clear-logs-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" d="M20.719 4.696a1 1 0 0 0-1.415-1.415l-4.796 4.796-.634-.635a3.002 3.002 0 0 0-3.788-.375l-7.64 5.093a1 1 0 0 0-.153 1.541l8.005 8.005a1.002 1.002 0 0 0 1.541-.152l5.093-7.64a3.001 3.001 0 0 0-.375-3.789l-.634-.633 4.796-4.796Zm-9.523 4.037a1 1 0 0 1 1.263.124l2.682 2.684a1 1 0 0 1 .126 1.262l-.414.621-4.278-4.277.62-.414ZM8.877 10.28l-4.305 2.87 1.43 1.43 1.294-1.292a1 1 0 0 1 1.415 1.415l-1.294 1.294 3.433 3.432 2.871-4.306-4.844-4.843Z"/>
                </svg>
                <span>Clear</span>
            </button>
        </div>
        <div class="logs-content">
            <div id="logsContainer"></div>
        </div>
    </div>

    <script>
        // Simple script to toggle the settings panel
        const settingsPanel = document.getElementById('translation-settings-panel');
        const openBtn = document.getElementById('translate-settings-btn');
        const closeBtn = document.getElementById('close-settings-btn');

        openBtn.addEventListener('click', () => settingsPanel.classList.remove('hidden'));
        closeBtn.addEventListener('click', () => settingsPanel.classList.add('hidden'));

        // Update summary text
        const sourceSelect = document.getElementById('source-language-select');
        const targetSelect = document.getElementById('target-language-select');
        const summarySource = document.getElementById('summary-source');
        const summaryTarget = document.getElementById('summary-target');

        function updateSummary() {
            summarySource.textContent = sourceSelect.querySelector('.selected-language-text').textContent;
            summaryTarget.textContent = targetSelect.querySelector('.selected-language-text').textContent;
        }

        sourceSelect.addEventListener('change', updateSummary);
        targetSelect.addEventListener('change', updateSummary);
        updateSummary(); // Initial call
    </script>
</body>
</html>